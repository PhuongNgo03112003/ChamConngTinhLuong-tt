# ğŸ“‹ Há»† THá»NG QUáº¢N LÃ NHÃ‚N Sá»° VÃ€ CHáº¤M CÃ”NG Báº°NG VÃ‚N TAY ESP32

> **Äá» tÃ i KhÃ³a luáº­n Tá»‘t nghiá»‡p** - Há»‡ thá»‘ng quáº£n lÃ½ nhÃ¢n sá»± tÃ­ch há»£p cháº¥m cÃ´ng báº±ng vÃ¢n tay qua thiáº¿t bá»‹ ESP32, vá»›i giao diá»‡n Web, Mobile vÃ  Chatbot AI thÃ´ng minh.

---

## ğŸ“– MÃ” Táº¢ Dá»° ÃN

Há»‡ thá»‘ng quáº£n lÃ½ nhÃ¢n sá»± toÃ n diá»‡n vá»›i cÃ¡c tÃ­nh nÄƒng:
- âœ… **Cháº¥m cÃ´ng tá»± Ä‘á»™ng báº±ng vÃ¢n tay** qua thiáº¿t bá»‹ ESP32
- âœ… **Quáº£n lÃ½ nhÃ¢n viÃªn** (thÃªm, sá»­a, xÃ³a, phÃ¢n quyá»n)
- âœ… **TÃ­nh lÆ°Æ¡ng tá»± Ä‘á»™ng** dá»±a trÃªn cháº¥m cÃ´ng, ngÃ y phÃ©p, tÄƒng ca
- âœ… **Quáº£n lÃ½ nghá»‰ phÃ©p vÃ  tÄƒng ca** vá»›i workflow phÃª duyá»‡t
- âœ… **Chatbot AI** há»— trá»£ tra cá»©u lÆ°Æ¡ng, ngÃ y phÃ©p, thÃ´ng tin nhÃ¢n viÃªn
- âœ… **Chat ná»™i bá»™** giá»¯a nhÃ¢n viÃªn vÃ  quáº£n lÃ½
- âœ… **Dashboard thá»‘ng kÃª** real-time vá»›i biá»ƒu Ä‘á»“ vÃ  bÃ¡o cÃ¡o
- âœ… **á»¨ng dá»¥ng Mobile** (React Native) cho nhÃ¢n viÃªn

---

TK:admin2
Mk:admin123
TK:EMP003
MK12345678
## ğŸš€ DEMO & DEPLOY LINKS

### ğŸŒ Frontend Web Application
- **Demo:** https://hrm-esp32-attendance.vercel.app/

### ğŸ“± Mobile Application
- **Android APK:** [Download APK]https://drive.google.com/drive/folders/1tDAUlPEOpOKYk10XT7gL9anGkQCxdKo4?hl=vi

### ğŸ”§ Backend API
- **API Base URL:** [https://khoaluantotnghiep-esp32-attendance.onrender.com/api](https://khoaluantotnghiep-esp32-attendance.onrender.com/api)
- **API Documentation:** [Swagger/Postman Collection](https://your-api-docs-link.com)

### ğŸ“¸ Video Demo
- **Screen Recording:** [Link Google Drive]([https://drive.google.com/your-folder](https://drive.google.com/drive/folders/1tDAUlPEOpOKYk10XT7gL9anGkQCxdKo4?hl=vi))

---

## ğŸ“¸ HÃŒNH áº¢NH MÃ€N HÃŒNH

### ğŸ–¥ï¸ Giao diá»‡n Web

#### 1. Trang ÄÄƒng nháº­p

<img width="1854" height="1020" alt="image" src="https://github.com/user-attachments/assets/e6500f52-eaac-4060-901d-545c3bcf7474" />

*Giao diá»‡n Ä‘Äƒng nháº­p vá»›i phÃ¢n quyá»n Manager/Employee/Accountant*

#### 2. Dashboard Quáº£n lÃ½
<img width="1866" height="950" alt="image" src="https://github.com/user-attachments/assets/4d0c1e71-3876-4ca6-83df-b06d282de0b8" />

*Dashboard tá»•ng quan vá»›i thá»‘ng kÃª real-time, biá»ƒu Ä‘á»“ cháº¥m cÃ´ng, vÃ  thÃ´ng bÃ¡o*

#### 3. Quáº£n lÃ½ NhÃ¢n viÃªn
![Employee Management]<img width="1869" height="947" alt="image" src="https://github.com/user-attachments/assets/cdd5b8a2-854b-403e-8f07-b75d94c9eabb" />

*Danh sÃ¡ch nhÃ¢n viÃªn vá»›i tÃ­nh nÄƒng tÃ¬m kiáº¿m, lá»c, vÃ  Ä‘Äƒng kÃ½ vÃ¢n tay*

#### 4. Cháº¥m cÃ´ng
![Attendance]<img width="1875" height="1023" alt="image" src="https://github.com/user-attachments/assets/bc206c0a-c780-4346-a496-c5e80b0485e3" />

*Lá»‹ch sá»­ cháº¥m cÃ´ng vá»›i lá»c theo thÃ¡ng, xuáº¥t Excel, vÃ  thá»‘ng kÃª*

#### 5. TÃ­nh lÆ°Æ¡ng
![Payroll]<img width="1851" height="1029" alt="image" src="https://github.com/user-attachments/assets/c1f6e466-17f5-4924-91c9-fbad729b4ae0" />

*Quáº£n lÃ½ lÆ°Æ¡ng vá»›i tÃ­nh toÃ¡n tá»± Ä‘á»™ng, Ä‘iá»u chá»‰nh, vÃ  lá»‹ch sá»­*

### ğŸ“± Giao diá»‡n Mobile

#### 1. MÃ n hÃ¬nh Home
![Mobile Home]
<img width="463" height="914" alt="image" src="https://github.com/user-attachments/assets/eb5856b9-4b2f-4ca5-970f-01215fc8dc81" />
<img width="806" height="568" alt="image" src="https://github.com/user-attachments/assets/b8c12e9c-427d-4520-a7cd-4e1c8991eea0" />

*Dashboard mobile vá»›i thÃ´ng tin cháº¥m cÃ´ng hÃ´m nay*

#### 2. Cháº¥m cÃ´ng Mobile
![Mobile Attendance]<img width="585" height="612" alt="image" src="https://github.com/user-attachments/assets/284c223d-cb10-467d-98b2-25879754c994" />

*Xem lá»‹ch sá»­ cháº¥m cÃ´ng vÃ  thá»‘ng kÃª trÃªn mobile*

## ğŸ› ï¸ CÃ”NG NGHá»† Sá»¬ Dá»¤NG

### Backend
- **Runtime:** Node.js 18+
- **Framework:** Express.js
- **Database:** MongoDB (Mongoose)
- **Authentication:** JWT (JSON Web Token)
- **Real-time:** Socket.IO
- **AI/ML:** OpenAI API (GPT-4o-mini)
- **Email:** Nodemailer (Gmail SMTP)
- **Scheduling:** node-cron (Auto-completion attendance)

### Frontend Web
- **Framework:** React 18
- **UI Library:** Ant Design 5
- **Routing:** React Router v6
- **State Management:** React Context API
- **Charts:** Recharts
- **Calendar:** FullCalendar
- **Real-time:** Socket.IO Client

### Mobile App
- **Framework:** React Native
- **Platform:** Expo
- **Navigation:** React Navigation
- **State Management:** React Context API

### ESP32 Firmware
- **Platform:** PlatformIO
- **Board:** ESP32 DevKit
- **Libraries:**
  - Adafruit Fingerprint Library
  - WiFiMulti (Multi-WiFi support)
  - NTP Client (Time synchronization)
  - HTTPClient (REST API calls)

### DevOps & Deployment
- **Backend Hosting:** Render.com
- **Frontend Hosting:** Vercel
- **Database:** MongoDB Atlas
- **Version Control:** Git

---

## ğŸ“ Cáº¤U TRÃšC Dá»° ÃN

```
KhoaLuanTotNghiep_ESP32_Attendance/
â”œâ”€â”€ backend/                    # Backend API (Node.js/Express)
â”‚   â”œâ”€â”€ controllers/           # Business logic controllers
â”‚   â”œâ”€â”€ models/                # MongoDB schemas
â”‚   â”œâ”€â”€ routes/                # API routes
â”‚   â”œâ”€â”€ middleware/            # Auth, error handling
â”‚   â”œâ”€â”€ services/              # Business services (AI, email, etc.)
â”‚   â”œâ”€â”€ socket/                # Socket.IO server
â”‚   â”œâ”€â”€ utils/                 # Helper functions
â”‚   â”œâ”€â”€ scripts/               # Database scripts
â”‚   â””â”€â”€ app.js                 # Main server file
â”‚
â”œâ”€â”€ frontend/                   # Web Frontend (React)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/        # Reusable components
â”‚   â”‚   â”œâ”€â”€ pages/             # Page components
â”‚   â”‚   â”œâ”€â”€ contexts/          # React contexts
â”‚   â”‚   â”œâ”€â”€ services/          # API services
â”‚   â”‚   â””â”€â”€ utils/             # Utilities
â”‚   â””â”€â”€ public/                # Static files
â”‚
â”œâ”€â”€ mobile/                     # Mobile App (React Native/Expo)
â”‚   â”œâ”€â”€ screens/               # Screen components
â”‚   â”œâ”€â”€ navigation/            # Navigation setup
â”‚   â”œâ”€â”€ services/              # API services
â”‚   â””â”€â”€ contexts/              # React contexts
â”‚
â”œâ”€â”€ esp32_vantay/              # ESP32 Firmware
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ main.cpp           # Main firmware code
â”‚   â””â”€â”€ platformio.ini         # PlatformIO config
â”‚
â””â”€â”€ docs/                      # Documentation
    â”œâ”€â”€ PhanTichHeThong_Code.md
    â””â”€â”€ class_diagram.puml
```

---

## âš™ï¸ CÃ€I Äáº¶T VÃ€ Cáº¤U HÃŒNH

### YÃªu cáº§u há»‡ thá»‘ng
- Node.js >= 18.x
- MongoDB >= 6.0 (hoáº·c MongoDB Atlas)
- Git
- PlatformIO (cho ESP32)
- ESP32 DevKit + Fingerprint Sensor + OLED Display

### 1. Clone repository

```bash
git clone https://github.com/your-username/KhoaLuanTotNghiep_ESP32_Attendance.git
cd KhoaLuanTotNghiep_ESP32_Attendance
```

### 2. Backend Setup

```bash
cd backend

# CÃ i Ä‘áº·t dependencies
npm install

# Táº¡o file config.env tá»« template
cp config.env.example config.env

# Chá»‰nh sá»­a config.env vá»›i thÃ´ng tin cá»§a báº¡n:
# - MONGODB_URI: Connection string MongoDB
# - JWT_SECRET: Secret key cho JWT
# - EMAIL_USER & EMAIL_APP_PASSWORD: Gmail credentials
# - IP_MACHINE: IP mÃ¡y chá»§ backend
# - IP_ESP32: IP thiáº¿t bá»‹ ESP32

# Cháº¡y seed data (tÃ¹y chá»n)
npm run seed:all

# Khá»Ÿi Ä‘á»™ng server
npm run dev        # Development mode
npm start          # Production mode
```

Backend sáº½ cháº¡y táº¡i: `http://localhost:3000`

### 3. Frontend Setup

```bash
cd frontend

# CÃ i Ä‘áº·t dependencies
npm install

# Cáº¥u hÃ¬nh API URL trong src/config.js
# Äáº·t BACKEND_URL = 'http://localhost:3000/api'

# Khá»Ÿi Ä‘á»™ng development server
npm start
```

Frontend sáº½ cháº¡y táº¡i: `http://localhost:3001`

### 4. Mobile App Setup

```bash
cd mobile

# CÃ i Ä‘áº·t dependencies
npm install

# Cáº¥u hÃ¬nh API URL trong config.js
# Äáº·t DEFAULT_API_URL = 'http://YOUR_SERVER_IP:3000/api'

# Khá»Ÿi Ä‘á»™ng Expo
npm start

# QuÃ©t QR code báº±ng Expo Go app trÃªn Ä‘iá»‡n thoáº¡i
```

### 5. ESP32 Firmware Setup

```bash
cd esp32_vantay

# Má»Ÿ project trong PlatformIO
# Hoáº·c sá»­ dá»¥ng VS Code vá»›i extension PlatformIO

# Cáº¥u hÃ¬nh WiFi trong src/main.cpp:
# - ThÃªm SSID vÃ  password vÃ o máº£ng WIFI_LIST
# - Cáº¥u hÃ¬nh server URL (hoáº·c Ä‘á»ƒ ESP32 tá»± Ä‘á»™ng láº¥y tá»« backend)

# Upload firmware lÃªn ESP32
pio run -t upload

# Xem serial monitor
pio device monitor
```

---

## ğŸ” TÃ€I KHOáº¢N Máº¶C Äá»ŠNH

### Admin/Manager
- **Username:** `admin`
- **Password:** `admin123`
- **Quyá»n:** Quáº£n lÃ½ toÃ n bá»™ há»‡ thá»‘ng

### Employee (Demo)
- **Username:** `EMP001`
- **Password:** `EMP001` (hoáº·c máº­t kháº©u Ä‘Æ°á»£c gá»­i qua email khi Ä‘Äƒng kÃ½ vÃ¢n tay)
- **Quyá»n:** Xem thÃ´ng tin cÃ¡ nhÃ¢n, cháº¥m cÃ´ng, lÆ°Æ¡ng

---

## ğŸ“š TÃNH NÄ‚NG CHI TIáº¾T

### 1. Cháº¥m cÃ´ng báº±ng VÃ¢n tay (ESP32)
- âœ… QuÃ©t vÃ¢n tay tá»± Ä‘á»™ng, khÃ´ng cáº§n nÃºt báº¥m
- âœ… Logic tá»± Ä‘á»™ng: Láº§n 1 = Check-in, Láº§n 2 = Check-out
- âœ… Äá»“ng bá»™ thá»i gian qua NTP
- âœ… Káº¿t ná»‘i WiFi tá»± Ä‘á»™ng (Multi-WiFi support)
- âœ… Hiá»ƒn thá»‹ tráº¡ng thÃ¡i trÃªn OLED
- âœ… Gá»­i dá»¯ liá»‡u real-time lÃªn server

### 2. Quáº£n lÃ½ NhÃ¢n viÃªn
- âœ… CRUD nhÃ¢n viÃªn (thÃªm, sá»­a, xÃ³a, tÃ¬m kiáº¿m)
- âœ… ÄÄƒng kÃ½ vÃ¢n tay qua ESP32
- âœ… Quáº£n lÃ½ lÆ°Æ¡ng vÃ  lá»‹ch sá»­ tÄƒng lÆ°Æ¡ng
- âœ… PhÃ¢n quyá»n (Manager/Accountant/Employee)
- âœ… Quáº£n lÃ½ nhÃ¢n viÃªn nghá»‰ viá»‡c

### 3. TÃ­nh lÆ°Æ¡ng Tá»± Ä‘á»™ng
- âœ… TÃ­nh lÆ°Æ¡ng dá»±a trÃªn cháº¥m cÃ´ng thá»±c táº¿
- âœ… Trá»« lÆ°Æ¡ng Ä‘i muá»™n, nghá»‰ khÃ´ng phÃ©p
- âœ… Cá»™ng tÄƒng ca (OT)
- âœ… TÃ­nh phá»¥ cáº¥p, thuáº¿
- âœ… LÆ°Æ¡ng "snapshot" (Ä‘Ã£ chá»‘t) vs "real-time" (táº¡m tÃ­nh)
- âœ… TÃ­nh lÆ°Æ¡ng "What-if" (náº¿u nghá»‰ thÃªm X ngÃ y)

### 4. Quáº£n lÃ½ Nghá»‰ phÃ©p & TÄƒng ca
- âœ… ÄÆ¡n nghá»‰ phÃ©p vá»›i workflow phÃª duyá»‡t
- âœ… ÄÆ¡n tÄƒng ca
- âœ… Lá»‹ch sá»­ vÃ  thá»‘ng kÃª
- âœ… ThÃ´ng bÃ¡o real-time cho Manager

### 5. Chatbot AI
- âœ… Tra cá»©u lÆ°Æ¡ng: "LÆ°Æ¡ng thÃ¡ng nÃ y cá»§a tÃ´i"
- âœ… Tra cá»©u ngÃ y phÃ©p: "TÃ´i cÃ²n bao nhiÃªu ngÃ y phÃ©p?"
- âœ… ThÃ´ng tin nhÃ¢n viÃªn: "ThÃ´ng tin cá»§a nhÃ¢n viÃªn EMP001"
- âœ… Dá»± bÃ¡o lÆ°Æ¡ng: "Náº¿u nghá»‰ thÃªm 2 ngÃ y thÃ¬ lÆ°Æ¡ng cÃ²n bao nhiÃªu?"
- âœ… Fallback regex khi OpenAI lá»—i

### 6. Chat Ná»™i bá»™
- âœ… Chat giá»¯a nhÃ¢n viÃªn vÃ  quáº£n lÃ½
- âœ… PhÃ¢n quyá»n: Employee chá»‰ chat vá»›i Manager/Accountant
- âœ… Real-time notifications
- âœ… Äáº¿m tin nháº¯n chÆ°a Ä‘á»c
- âœ… Lá»‹ch sá»­ tin nháº¯n

### 7. Dashboard & Thá»‘ng kÃª
- âœ… Thá»‘ng kÃª cháº¥m cÃ´ng real-time
- âœ… Biá»ƒu Ä‘á»“ xu hÆ°á»›ng
- âœ… BÃ¡o cÃ¡o theo thÃ¡ng/nÄƒm
- âœ… ThÃ´ng bÃ¡o vÃ  alerts

---

## ğŸ”§ Cáº¤U HÃŒNH NÃ‚NG CAO

### Time Machine (Test Mode)
Há»‡ thá»‘ng há»— trá»£ "Time Machine" Ä‘á»ƒ test vá»›i ESP32 tháº­t:
- Cho phÃ©p set thá»i gian áº£o trÃªn server
- Test cÃ¡c trÆ°á»ng há»£p: Ä‘i muá»™n, tÄƒng ca, nghá»‰ phÃ©p
- **LÆ°u Ã½:** Chá»‰ báº­t trong mÃ´i trÆ°á»ng test, táº¯t trong production

```env
ENABLE_TEST_MODE=true
```

### Auto-completion Attendance
Há»‡ thá»‘ng tá»± Ä‘á»™ng hoÃ n táº¥t cháº¥m cÃ´ng cho nhÃ¢n viÃªn quÃªn check-out:
- Cháº¡y cron job má»—i ngÃ y vÃ o giá» káº¿t thÃºc ca (máº·c Ä‘á»‹nh: 17:00)
- Tá»± Ä‘á»™ng táº¡o check-out náº¿u thiáº¿u

### Email Notifications
- Gá»­i email khi Ä‘Äƒng kÃ½ vÃ¢n tay thÃ nh cÃ´ng (kÃ¨m thÃ´ng tin Ä‘Äƒng nháº­p)
- Gá»­i email thÃ´ng bÃ¡o Ä‘Æ¡n nghá»‰ phÃ©p/tÄƒng ca
- Cáº¥u hÃ¬nh trong `backend/config.env`

---

## ğŸ› Xá»¬ LÃ Lá»–I THÆ¯á»œNG Gáº¶P

### ESP32 khÃ´ng káº¿t ná»‘i Ä‘Æ°á»£c server
1. Kiá»ƒm tra ESP32 vÃ  server cÃ¹ng máº¡ng WiFi
2. Kiá»ƒm tra IP server trong config ESP32
3. Kiá»ƒm tra firewall/port 3000
4. Xem log serial monitor ESP32

### MongoDB connection error
1. Kiá»ƒm tra `MONGODB_URI` trong `config.env`
2. Kiá»ƒm tra MongoDB Atlas whitelist IP
3. Kiá»ƒm tra username/password

### Frontend khÃ´ng káº¿t ná»‘i backend
1. Kiá»ƒm tra `BACKEND_URL` trong `src/config.js`
2. Kiá»ƒm tra CORS settings trong backend
3. Kiá»ƒm tra backend Ä‘ang cháº¡y

---

## ğŸ“ API DOCUMENTATION

### Authentication
- `POST /api/auth/login` - ÄÄƒng nháº­p
- `POST /api/auth/register` - ÄÄƒng kÃ½ (Admin only)
- `GET /api/auth/me` - Láº¥y thÃ´ng tin user hiá»‡n táº¡i

### Employees
- `GET /api/employees` - Láº¥y danh sÃ¡ch nhÃ¢n viÃªn
- `POST /api/employees` - Táº¡o nhÃ¢n viÃªn má»›i
- `PUT /api/employees/:id` - Cáº­p nháº­t nhÃ¢n viÃªn
- `DELETE /api/employees/:id` - XÃ³a nhÃ¢n viÃªn
- `GET /api/enroll?id=X` - ÄÄƒng kÃ½ vÃ¢n tay cho nhÃ¢n viÃªn

### Attendance
- `POST /api/attendance/add` - ThÃªm cháº¥m cÃ´ng (ESP32)
- `GET /api/attendance` - Láº¥y lá»‹ch sá»­ cháº¥m cÃ´ng
- `GET /api/attendance/stats` - Thá»‘ng kÃª cháº¥m cÃ´ng

### Payroll
- `GET /api/payroll` - Láº¥y danh sÃ¡ch lÆ°Æ¡ng
- `POST /api/payroll/generate` - Táº¡o báº£ng lÆ°Æ¡ng thÃ¡ng
- `GET /api/payroll/my-payroll` - LÆ°Æ¡ng cá»§a tÃ´i

Xem thÃªm trong file `backend/routes/` hoáº·c Postman Collection.

---

## ğŸ¤ ÄÃ“NG GÃ“P

Má»i Ä‘Ã³ng gÃ³p Ä‘á»u Ä‘Æ°á»£c chÃ o Ä‘Ã³n! Vui lÃ²ng:
1. Fork repository
2. Táº¡o feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Má»Ÿ Pull Request

---

## ğŸ“„ LICENSE

Dá»± Ã¡n nÃ y Ä‘Æ°á»£c phÃ¡t triá»ƒn cho má»¥c Ä‘Ã­ch há»c táº­p vÃ  nghiÃªn cá»©u (KhÃ³a luáº­n Tá»‘t nghiá»‡p).

---
## ğŸ™ Lá»œI Cáº¢M Æ N

Cáº£m Æ¡n cÃ¡c thÆ° viá»‡n vÃ  cÃ´ng cá»¥ mÃ£ nguá»“n má»Ÿ Ä‘Ã£ há»— trá»£:
- React, Node.js, Express.js
- MongoDB, Mongoose
- Ant Design
- Socket.IO
- OpenAI API
- PlatformIO
- VÃ  táº¥t cáº£ cÃ¡c contributors khÃ¡c

---

**â­ Náº¿u dá»± Ã¡n nÃ y há»¯u Ã­ch, hÃ£y cho má»™t star! â­**

